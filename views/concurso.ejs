<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="/css/home.css" />
    <link rel="stylesheet" href="/css/concurso.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
      integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2"
      crossorigin="anonymous"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Righteous&amp;display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"
    />

    <title>Concurso</title>
  </head>

  <body>
    <%- include('components/navbar.ejs'); %>
    <br /><br /><br />

    <div class="container">
      <br /><br /><br />
      <br />
      <h2>
        Olá, <%=nome.nome%> <%=nome.sobrenome%> <%if((nome.id == 1) || (nome.id
        == 54) || (nome.id == 83) || (nome.id == 81)){%>
        <div class="btnToggle">
          <form action="/btndisable" method="post">
            <label class="switch">
              <input type="hidden" name="etapolas" value="<%=nextEtapa%>" />
              <input
                type="hidden"
                id="statusBtn"
                name="statusBtn"
                value="<%=btnStatus%>"
              />
              <input
                name="btnDisable"
                type="checkbox"
                value=""
                id="terms_and_conditions"
                onclick="terms_changed(this)"
              />
              <span class="slider round"></span>
            </label>
            <button class="btn btn-lg btnLogin text-white" id="DesAct" style="display: none;"></button>
          </form>
        </div>
        <%}%>
      </h2>
      <div class="container">
        <div class="row">
          <div
            class="col-6"
            style="background-color: #f5f5f5; border-radius: 12px"
          >
            <h5 class="w-100 my-3" style="color: red !important">
              <%=msg%> <br />
              Ver <a href="/users" class="link_conc">Meus Palpites.</a>
            </h5>
          </div>
          <div class="col-6"></div>
        </div>
      </div>

      <br />
      <script type="text/javascript">
        function verify() {
          var p1 = document.querySelector('input[name="p1"]:checked').id;
          document.querySelector("#p1p").innerHTML = p1;
          console.log(p1);

          var p2 = document.querySelector('input[name="p2"]:checked').id;
          document.querySelector("#p2p").innerHTML = p2;

          var p3 = document.querySelector('input[name="p3"]:checked').id;
          document.querySelector("#p3p").innerHTML = p3;

          var p4 = document.querySelector('input[name="p4"]:checked').id;
          document.querySelector("#p4p").innerHTML = p4;

          var p5 = document.querySelector('input[name="p5"]:checked').id;
          document.querySelector("#p5p").innerHTML = p5;
        }
      </script>
      <%if((nome.id == 1) || (nome.id
      == 54) || (nome.id == 83) || (nome.id == 81)){%>
      <div class="row p-2">
        <div class="col-md-6">

        </div>
        <div class="col-md-6">
          <div class="row justify-content-center">
            <p>Trocar imagem do Banner</p>
            <form method="POST" enctype="multipart/form-data" action="/addImageBanner">
              <div class="custom-file mt-2">
                
                  <input type="file" name="imgBannerConc" class="custom-file-input"
                      id="validatedCustomFile" accept="">
                  <label class="custom-file-label" for="validatedCustomFile" style="font-size: 16px;">Selecione um Banner
                  </label>
                  <p style="font-size: 14px; color: gray;">A imagem deve ter o nome exato de <strong style="color: red;">BannerConc</strong> e com a extensão no formato <strong style="color: red;">.jfif</strong></p>
              </div>
              <input type="submit" value="Enviar">
          </form>
          <p><%=msgImg%></p>
          </div>
        </div>
      </div>
      <%}%>
      <div class="row">
        <div class="col-md-6">
          <div class="card" style="width: 18rem">
            <div class="card-body">
              <div class="text-center">
                <h3>Seu Palpite</h3>
              </div>

              <hr />
              <h5>
                Pole Position:
                <div id="p4p" style="color: crimson"></div>
              </h5>
              <br />
              <h5>
                1°:
                <div id="p1p" style="color: crimson"></div>
              </h5>
              <br />
              <h5>
                2°:
                <div id="p2p" style="color: crimson"></div>
              </h5>
              <br />
              <h5>
                3°:
                <div id="p3p" style="color: crimson"></div>
              </h5>
              <br />
              <h5>
                Volta mais Rapida:
                <div id="p5p" style="color: crimson"></div>
              </h5>

              <hr />
              <div class="row">
                <div class="col-md-6 my-2">
                  <button class="btn btn-success btn-md" onclick="verify()">
                    Verificar
                  </button>
                </div>
                <div class="col-md-6 my-2">
                  <button
                    class="btn btn-md btn-danger"
                    onClick="window.location.reload();"
                  >
                    Deletar
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6 d-flex justify-content-center align-items-center">
          <div class="">
            <img
              src="/img/upload/banners/BannerConc.jfif"
              class="img-fluid img-banner"
              alt=""
            />
          </div>
        </div>
      </div>

      <br />

      <div class="tabela m-0 w-100">
        <div class="container-form">
          <form method="POST" action="/salvarPalpite" class="w-100">
            <div class="titulo w-100 m-0">
              <div class="form-group col-md-8">
                <label>Etapa do Palpite: </label>
                <select
                  class="form-control bg-warning"
                  id="etapaP"
                  name="etapaP"
                  style="font-size: 25px"
                >
                  <% calendar.forEach(calendar=>{ %>
                  <%if(calendar.id==nextEtapa){%>
                  <option
                    value="<%=nextEtapa%>"
                    class="optionEtapa"
                    style="font-size: 25px"
                  >
                    GP <%=nextEtapa%> - <%= calendar.corrida %>
                  </option>
                  <%}%> <%})%>
                </select>
              </div>
            </div>
            <%if(btnStatus == 1){%>
            <button
              class="btn btnEnvPalp btn-lg btnLogin my-3 text-white w-100"
              id="myBtn" disabled
            >
              Enviar Palpite
            </button>
            <%}else{%>
            <button
              class="btn btnEnvPalp btn-lg btnLogin my-3 text-white w-100"
              id="myBtn"
            >
              Enviar Palpite
            </button>
            <%}%>

            <table class="table table-dark table-responsive-lg w-100">
              <thead>
                <tr>
                  <th scope="col hashtag" style="text-align: center">#</th>
                  <th scope="col">Pilotos</th>
                  <th scope="col">Pole</th>
                  <th scope="col">1°</th>
                  <th scope="col">2°</th>
                  <th scope="col">3°</th>
                  <th scope="col">V.R</th>
                </tr>
              </thead>
              <tbody>
                <% pilots.forEach(pilot=>{ %>
                <tr class="<%= pilot.escuderia %>">
                  <th scope="row">
                    <p class="text-black"><%= pilot.numero %></p>
                  </th>
                  <th scope="row"><%= pilot.piloto %></th>
                  <td>
                    <div class="form-check form-check-inline">
                      <input
                        name="p4"
                        class="form-check-input"
                        type="radio"
                        id="<%= pilot.piloto %>"
                        value="<%= pilot.numero %>"
                      />
                    </div>
                  </td>
                  <td>
                    <div class="form-check form-check-inline">
                      <input
                        name="p1"
                        class="form-check-input"
                        onClick="not_repeat"
                        type="radio"
                        id="<%= pilot.piloto %>"
                        value="<%= pilot.numero %>"
                      />
                    </div>
                  </td>
                  <td>
                    <div class="form-check form-check-inline">
                      <input
                        name="p2"
                        class="form-check-input"
                        onClick="not_repeat"
                        type="radio"
                        id="<%= pilot.piloto %>"
                        value="<%= pilot.numero %>"
                      />
                    </div>
                  </td>

                  <td>
                    <div class="form-check form-check-inline">
                      <input
                        name="p3"
                        class="form-check-input"
                        onClick="not_repeat"
                        type="radio"
                        id="<%= pilot.piloto %>"
                        value="<%= pilot.numero %>"
                      />
                    </div>
                  </td>

                  <td>
                    <div class="form-check form-check-inline">
                      <input
                        name="p5"
                        class="form-check-input"
                        type="radio"
                        id="<%= pilot.piloto %>"
                        value="<%= pilot.numero %>"
                      />
                    </div>
                  </td>
                </tr>
                <%})%>
              </tbody>
            </table>
          </form>
        </div>
      </div>
    </div>
    <%- include('components/footer.ejs'); %>
    <script>
      var btnDisable = 0;
      var checkobox = document.querySelector("#terms_and_conditions")
      var statusBtnEnv = $('#statusBtn').val()
      

      function terms_changed(termsCheckBox) {
        if (termsCheckBox.checked) {
          $("#DesAct").show()
          btnDisable = 1;
          console.log("BTN: " + btnDisable);
          document.getElementById("myBtn").disabled = true;
          document.getElementsByName("btnDisable").value = '1'
          document.getElementById("DesAct").innerText = "Desabilitar"
          document.getElementById("DesAct").style.transition = "all 0.5s";
        } if(!termsCheckBox.checked) {
          $("#DesAct").show()
          btnDisable = btnDisable - 1;
          console.log("BTN: " + btnDisable);
          document.getElementById("myBtn").disabled = false;
          document.getElementsByName("btnDisable").value = 0
          console.log('BTN VALUE: '+document.getElementsByName("btnDisable").value)
          document.getElementById("DesAct").innerText = "Habilitar"
          document.getElementById("DesAct").style.transition = "all 0.5s";
        }
        return btnDisable;
      }

      if(statusBtnEnv == 1){
        document.getElementById("myBtn").disabled = true;
      
      }else{
        document.getElementById("myBtn").disabled = false;
        
      }
    </script>
    <script
      src="https://code.jquery.com/jquery-3.5.1.slim.min.js"
      integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
      crossorigin="anonymous"
    ></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
